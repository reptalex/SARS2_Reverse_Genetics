{
    "collab_server" : "",
    "contents" : "library(ape)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(magrittr)\nlibrary(xlsx)\nlibrary(rentrez)\nlibrary(DECIPHER)\ntheme_set(theme_bw(base_size=15))\n\n# https://journals.asm.org/doi/10.1128/JVI.02583-14\n\n## Modified NiV\n# NC_002728.1 - subsequently modified below\n\n## \"The NiV sequence matches NCBI accession no. NC_002728.1 except for one silent mutation in N, A649G\"\n## The authors above inserted a silent A-->G mutation\n\n## \"it was not necessary to introduce artificial restriction sites (except for a single introduced site \n## usually flanking the 3′ end of the reporter gene for cloning convenience)\"\n\n# ---------\n\n## Modified HeV:\n# GenBank accession no. AF017149 - subsequently modified below\n## Positive-sense cDNA was amplified from HeV prototype strain (GenBank accession no. AF017149) \n## \" The HHrbz sequence in stem I designed to anneal to the NiV 3′ leader, TTGGT, was mutated to TCGGT so\n## as to match the HeV 3′ leader. For the support plasmids, HeV-N, -P, and -L were cloned into pTM1 as\n## described previously for NiV (33), with the two C ORF start codons mutated in P (from ATGATG to ACGACG) \n## to prevent potential inhibition of rescue (34).\n  \n  \n## Modified Cedar:\n# rCedPV\n# https://virologyj.biomedcentral.com/articles/10.1186/s12985-018-0964-0\n# NCBI Accession number NC_025351.1 - subsequently modified below\n\n# internal SmaI restriction sites in the CedPV reference genome were removed (C395A and C4816A) in the \n# rCedPV cDNA clone to preserve the cloning strategy. A MluI restriction site was created between the \n# P and M genes at nucleotide position 4531\n\n\n\n## Modified SARS-CoVs  ### Sims + Baric - also both on NIH grant no. 1U01Al151797-01\n# https://pubmed.ncbi.nlm.nih.gov/26976607/\n# WIV1-CoV made by: \"constructing chimeric and full-length zoonotic coronaviruses to evaluate emergence potential\"\n\n\ndata(\"RESTRICTION_ENZYMES\")\nres <- RESTRICTION_ENZYMES\n\ndigest_fragment_lengths <- function(seq,res.=res,id='A'){\n  output=NULL\n  for (re in names(res)){\n    re_site=RESTRICTION_ENZYMES[re]\n    d=DigestDNA(re_site,\n                seq,\n                type='fragments',\n                strand='top')\n    dd=unlist(d)\n    \n    dum=data.table('id'=id,\n                   'fragment_lengths'=dd@ranges@width,\n                   'Restriction_Enzyme'=re)\n    output=rbind(output,dum)\n  }\n  return(output)\n  \n}\n\n# analysis ----------------------------------------------------------------\n## Modified Cedar:\n# rCedPV\n# https://virologyj.biomedcentral.com/articles/10.1186/s12985-018-0964-0\n# NCBI Accession number NC_025351.1 - subsequently modified below\naccn='NC_025351.1'\n# internal SmaI restriction sites in the CedPV reference genome were removed (C395A and C4816A) in the \n# rCedPV cDNA clone to preserve the cloning strategy. A MluI restriction site was created between the \n# P and M genes at nucleotide position 4531\n\naccs <- rentrez::entrez_search('nucleotide',term=accn)\n\nentrez_fetch(db=\"nucleotide\", id=accs$ids, rettype=\"fasta\") %>%\n  write(file='data/Cedar_genome.fasta')\n\n\nseq= read.FASTA('data/NiV_genome.fasta') %>% as.character %>%\n  lapply(.,paste0,collapse=\"\") %>% unlist %>% DNAStringSet\n\nseq_modified=as.character(seq)\nsubstr(seq_modified,395,395) <- \"A\"\nsubstr(seq_modified,4816,4816) <- 'A'\nseq_modified <- DNAStringSet(seq_modified)\n\nLs <- rbind(digest_fragment_lengths(seq,id='CeD'),\n            digest_fragment_lengths(seq_modified,id='rCeD'))\n\n\nmax_Ls <- Ls[,list(max_fragment_length=max(fragment_lengths),\n                   no_fragments=.N),by=c('id','Restriction_Enzyme')][no_fragments<=30]\n\nmax_Ls[,list(delta=diff(max_fragment_length)),by='Restriction_Enzyme'][order(delta)]\n\n# A MluI restriction site was created between the P and M genes at nucleotide position 4531\n# after the M transcriptional start sequence, to facilitate insertion of a modified turbo Green\n# Fluorescent Protein (GFP) gene\n\n## If so, then the max_Ls for MluI in this would leave a max segment of \n\nnchar(seq)-4531\n\nggplot(max_Ls,aes(factor(no_fragments),max_fragment_length))+\n  geom_boxplot()+\n  geom_jitter(alpha=0.3)+\n  geom_point(data=max_Ls[Restriction_Enzyme=='MluI'],color='red')+\n  scale_x_discrete('Number of Fragments')+\n  scale_y_continuous('Maximum Fragment Length')+\n  geom_jitter(data=max_Ls[id=='rNiV'],color='red')\n#\n",
    "created" : 1664831570079.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1971479150",
    "id" : "A06608AE",
    "lastKnownWriteTime" : 1663822364,
    "last_content_update" : 1663822364,
    "path" : "~/COVID/Origins/RestrictionSites/scripts/NiV_HeV_restriction_mapping.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}